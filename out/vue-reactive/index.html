<!DOCTYPE html><html lang="en" class="__className_577ed0"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/1f3fe8c6df3d47c1-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/4f05ba3a6752a328-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/82050c55ac1c8c11-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" as="image" href="https://avatars.githubusercontent.com/u/52339771?v=4"/><link rel="stylesheet" href="/_next/static/css/48df2138df2e6856.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/7198505728be4078.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/354c4f287ddbdae0.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/56ee663620872bf0.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-cc6f4bbd58f02c04.js"/><script src="/_next/static/chunks/2ef8672f-bc2daebf9fe2c5a3.js" async=""></script><script src="/_next/static/chunks/520-d0847c1effd7724e.js" async=""></script><script src="/_next/static/chunks/main-app-9923c9d1e6347b08.js" async=""></script><script src="/_next/static/chunks/252-c08bd2e6e79378f4.js" async=""></script><script src="/_next/static/chunks/app/%5Bslug%5D/layout-c8e9a29bffafb4da.js" async=""></script><script src="/_next/static/chunks/app/%5Bslug%5D/page-8d1acff9edb9c31b.js" async=""></script><meta name="next-size-adjust" content=""/><title>别拿“父传子、子传父”吓我了 — overreacted</title><meta name="description" content="献给在 props、emit、eventBus、provide/inject 之间迷失的你"/><link rel="icon" href="/icon.png?e0852c1e2c7f0e65" type="image/png" sizes="329x329"/><script>document.querySelectorAll('body link[rel="icon"], body link[rel="apple-touch-icon"]').forEach(el => document.head.appendChild(el))</script><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="mx-auto max-w-2xl bg-[--bg] px-5 py-12 text-[--text]"><header class="mb-14 flex flex-row place-content-between"><a class="__className_096e99 inline-block text-2xl font-black hover:scale-[1.02] scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="/"><span style="--myColor1:var(--pink);--myColor2:var(--purple);background-image:linear-gradient(45deg, var(--myColor1), var(--myColor2));background-clip:text;-webkit-background-clip:text;color:transparent;transition:--myColor1 0.2s ease-out, --myColor2 0.2s ease-in-out">overreacted</span></a><span class="relative top-[4px] italic">by<!-- --> <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://swanine.com"><img alt="Swanine" src="https://avatars.githubusercontent.com/u/52339771?v=4" class="relative -top-1 mx-1 inline h-8 w-8 rounded-full"/></a></span></header><main><article><h1 class="__className_096e99 text-[40px] font-black leading-[44px] text-[--title]">别拿“父传子、子传父”吓我了</h1><p class="mt-2 text-[13px] text-gray-700 dark:text-gray-300">December 11, 2023</p><div class="markdown mt-10"><p>我们从小就被告诫，组件之间要“数据单向流动”。Vue 也这样教我们：
<strong>父组件通过 <code>props</code> 给子组件传值，子组件通过 <code>$emit</code> 通知父组件某个事件发生了</strong>。</p>
<p>但你写久了之后就会发现：
这事儿根本没那么简单。</p>
<p>场景一复杂，层级一多，Vue 的组件通信就会逐渐从“清水煮白菜”变成了“七大姑八大姨串门”——一个 <code>props</code> 传了五层，一个 <code>emit</code> 被转发三手，一个兄弟组件用全局事件乱吼……</p>
<p>别慌，其实这些情况很常见，只是我们以前在学组件通信的时候，太过理想化了。</p>
<p>这篇文章我就想聊聊：Vue 组件通信这回事，应该怎么看、怎么写、怎么不把自己写崩。</p>
<hr/>
<h4>🧭 组件通信的五大派别（别背 API，先理解思路）</h4>
<p>Vue 组件通信，其实就这几个套路，每一种都有适合它的“场景生态位”：</p>
<table class="grid w-full grid-cols-[auto_auto] border-b border-gray-900/10 dark:border-white/10"><thead class="col-span-3 grid grid-cols-subgrid"><tr class="col-span-3 grid grid-cols-subgrid"><th class="px-2 py-2.5 text-left text-sm/7 font-semibold text-gray-950 dark:text-white">通信方式</th><th class="px-2 py-2.5 text-left text-sm/7 font-semibold text-gray-950 dark:text-white">适合场景</th><th class="px-2 py-2.5 text-left text-sm/7 font-semibold text-gray-950 dark:text-white">特点</th></tr></thead><tbody class="col-span-3 grid grid-cols-subgrid border-t border-gray-900/10 dark:border-white/10"><tr class="col-span-3 grid grid-cols-subgrid border-b border-gray-950/5 dark:border-white/5"><td class="px-2 py-2 align-top font-mono text-xs/6 font-medium ">props / emit</td><td class="px-2 py-2 align-top font-mono text-xs/6 font-medium ">父子之间</td><td class="px-2 py-2 align-top font-mono text-xs/6 font-medium ">单向传值、简单直白</td></tr><tr class="col-span-3 grid grid-cols-subgrid border-b border-gray-950/5 dark:border-white/5"><td class="px-2 py-2 align-top font-mono text-xs/6 font-medium ">provide / inject</td><td class="px-2 py-2 align-top font-mono text-xs/6 font-medium ">跨层级的祖孙关系</td><td class="px-2 py-2 align-top font-mono text-xs/6 font-medium ">解耦、隐式依赖</td></tr><tr class="col-span-3 grid grid-cols-subgrid border-b border-gray-950/5 dark:border-white/5"><td class="px-2 py-2 align-top font-mono text-xs/6 font-medium ">事件总线（eventBus）</td><td class="px-2 py-2 align-top font-mono text-xs/6 font-medium ">松耦合兄弟、跨组件</td><td class="px-2 py-2 align-top font-mono text-xs/6 font-medium ">灵活但容易失控</td></tr><tr class="col-span-3 grid grid-cols-subgrid border-b border-gray-950/5 dark:border-white/5"><td class="px-2 py-2 align-top font-mono text-xs/6 font-medium ">Vuex / Pinia</td><td class="px-2 py-2 align-top font-mono text-xs/6 font-medium ">跨页面、跨组件、共享状态</td><td class="px-2 py-2 align-top font-mono text-xs/6 font-medium ">官方推荐、适合复杂项目</td></tr><tr class="col-span-3 grid grid-cols-subgrid not-last:border-b not-last:border-gray-950/5 dark:not-last:border-white/5"><td class="px-2 py-2 align-top font-mono text-xs/6 font-medium ">自定义 hooks / composables</td><td class="px-2 py-2 align-top font-mono text-xs/6 font-medium ">可复用状态逻辑</td><td class="px-2 py-2 align-top font-mono text-xs/6 font-medium ">灵活组合、自带响应性</td></tr></tbody></table>
<p>这些方式没有对错，<strong>关键看你项目的规模和数据流动的复杂度</strong>。</p>
<h3>🧒 父传子、子传父：新手村里的套路，也有进阶写法</h3>
<p>Vue 最基础的通信方式就是 <code>props</code> 和 <code>$emit</code>，学起来简单，但写起来其实也能很“优雅”。</p>
<p><strong>✅ 正常写法：</strong></p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="vue" data-theme="default"><code data-language="vue" data-theme="default" style="display:grid"><span data-line=""><span style="color:#637777">&lt;!-- 父组件 --&gt;</span></span>
<span data-line=""><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">MyInput</span><span style="color:#CED2D6"> :</span><span style="color:#C792EA">value=</span><span style="color:#C792EA">&quot;</span><span style="color:#CED2D6">username</span><span style="color:#C792EA">&quot;</span><span style="color:#CED2D6"> @</span><span style="color:#C792EA">update=</span><span style="color:#C792EA">&quot;</span><span style="color:#CED2D6">username </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> $event</span><span style="color:#C792EA">&quot;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">/&gt;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#637777">&lt;!-- 子组件 --&gt;</span></span>
<span data-line=""><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">template</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">input</span><span style="color:#C792EA"> :value=</span><span style="color:#C792EA">&quot;</span><span style="color:#ECC48D">value</span><span style="color:#C792EA">&quot;</span><span style="color:#C792EA"> @input=</span><span style="color:#C792EA">&quot;</span><span style="color:#ECC48D">$emit(&#x27;update&#x27;, $event.target.value)</span><span style="color:#C792EA">&quot;</span><span style="color:#C792EA"> /&gt;</span></span>
<span data-line=""><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">template</span><span style="color:#C792EA">&gt;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">script</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">setup&gt;</span></span>
<span data-line=""><span style="color:#8EACE3">defineProps</span><span style="color:#C792EA">([</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">value</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">])</span></span>
<span data-line=""><span style="color:#8EACE3">defineEmits</span><span style="color:#C792EA">([</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">update</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">])</span></span>
<span data-line=""><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">script</span><span style="color:#C792EA">&gt;</span></span></code></pre></div>
<p>这就是我们常说的“受控组件”：父组件管控数据，子组件通知变化。</p>
<p><strong>🚀 更进一步：v-model 语法糖</strong></p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="vue" data-theme="default"><code data-language="vue" data-theme="default" style="display:grid"><span data-line=""><span style="color:#637777">&lt;!-- 父组件 --&gt;</span></span>
<span data-line=""><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">MyInput</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">v-model=</span><span style="color:#C792EA">&quot;</span><span style="color:#CED2D6">username</span><span style="color:#C792EA">&quot;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">/&gt;</span></span></code></pre></div>
<p>你以为这是语法糖，其实底层就是 <code>:modelValue</code> + <code>@update:modelValue</code>，Vue 帮你自动做了参数和事件名的约定而已。</p>
<p>写起来舒服多了，也方便统一封装一堆表单类组件。</p>
<hr/>
<h3>👴 provide / inject：爷爷给孙子发钱，谁也别告诉爸爸</h3>
<p>当你 <code>props</code> 传了三四层，组件都在当“中转站”时，就该考虑换个思路了。</p>
<p>Vue 提供了 <code>provide</code> / <code>inject</code>，可以让<strong>祖先组件向任意后代组件提供数据</strong>，后代随用随取，不需要层层传递。</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default" style="display:grid"><span data-line=""><span style="color:#637777">// App.vue</span></span>
<span data-line=""><span style="color:#8EACE3">provide</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">theme</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">,</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">dark</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">)</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#637777">// Button.vue（第5层）</span></span>
<span data-line=""><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">theme</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">inject</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">theme</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">)</span></span></code></pre></div>
<p>这套机制适合“全局但不常变的数据”，比如主题、语言、配置项等等。</p>
<blockquote>
<p>❗ 提醒：虽然它很方便，但用多了容易让组件间关系变得隐蔽，阅读成本高。所以更适合“结构性通信”，不太适合“业务值通信”。</p>
</blockquote>
<hr/>
<h3>🤝 兄弟组件通信：你俩又不认识，别硬聊！</h3>
<p>兄弟组件不能直接用 <code>props/emit</code>，但有时偏偏要互动，比如：</p>
<ul>
<li>左边的侧边栏点击切换，右边内容区要响应</li>
<li>表格和分页是兄弟组件，共享查询参数</li>
</ul>
<p>这时有几种方式可以解耦：</p>
<p><strong>✅ 共享父组件作为“中介人”</strong></p>
<p>父组件统一管理状态，两个兄弟通过 <code>props</code> 和 <code>emit</code> 各自接入。</p>
<p><strong>💣 用 eventBus 快速接上（但别上瘾）</strong></p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default" style="display:grid"><span data-line=""><span style="color:#637777">// eventBus.js</span></span>
<span data-line=""><span style="color:#FFA7C4">export const </span><span style="color:#CED2D6">eventBus</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">mitt</span><span style="color:#C792EA">();</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#637777">// A组件</span></span>
<span data-line=""><span style="color:#FFA7C4">eventBus</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">emit</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">search</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">,</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">关键词</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">)</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#637777">// B组件</span></span>
<span data-line=""><span style="color:#FFA7C4">eventBus</span><span style="color:#C792EA">.</span><span style="color:#8EACE3">on</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">search</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">,</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">(</span><span style="color:#CED2D6">val</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">doSearch</span><span style="color:#C792EA">(</span><span style="color:#CED2D6">val</span><span style="color:#C792EA">)</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">})</span></span></code></pre></div>
<p>这方式快捷灵活，但容易到处注册/解绑，特别容易内存泄漏 or 逻辑混乱。建议小项目或 demo 里用用，别做核心依赖。</p>
<hr/>
<h3>🏢 Pinia / Vuex：让组件都变成“打工人”</h3>
<p>如果一个状态不仅要被多个组件使用，还要长期存在（比如用户信息、购物车数据、权限表），这时候你就该上 Pinia 了。</p>
<p>它其实是一个“响应式的数据工厂”：你在里面定义状态、动作，组件从中取用和更新，一切都响应式同步。</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default" style="display:grid"><span data-line=""><span style="color:#637777">// store/user.js</span></span>
<span data-line=""><span style="color:#FFA7C4">export const </span><span style="color:#CED2D6">useUserStore</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">defineStore</span><span style="color:#C792EA">(</span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">user</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#FFA7C4">  </span><span style="color:#8EACE3">state</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">({</span><span style="color:#CED2D6"> name</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">小张</span><span style="color:#C792EA">&#x27;</span><span style="color:#C792EA">,</span><span style="color:#CED2D6"> token</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;&#x27;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">}),</span></span>
<span data-line=""><span style="color:#FFA7C4">  </span><span style="color:#CED2D6">actions</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">logout</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">this</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">token </span><span style="color:#C792EA">=</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;&#x27;</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#C792EA">})</span></span></code></pre></div>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="vue" data-theme="default"><code data-language="vue" data-theme="default" style="display:grid"><span data-line=""><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">script</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">setup&gt;</span></span>
<span data-line=""><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">user</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useUserStore</span><span style="color:#C792EA">()</span></span>
<span data-line=""><span style="color:#FFA7C4">user</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">name </span><span style="color:#637777">// 响应式的</span></span>
<span data-line=""><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">script</span><span style="color:#C792EA">&gt;</span></span></code></pre></div>
<p>现在 Vue 的状态管理，已经越来越模块化、组合化，Pinia 比 Vuex 更轻量，语法也更现代。</p>
<hr/>
<h3>🧩 自定义 composable：组件通信之外的终极解耦武器</h3>
<p>最后介绍一个高手段：<strong>提取状态和逻辑到</strong> <code>useXXX()</code> ** composable 函数中**，多个组件使用同一个逻辑，就天然“通信”了。</p>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default" style="display:grid"><span data-line=""><span style="color:#637777">// useCounter.js</span></span>
<span data-line=""><span style="color:#FFA7C4">import</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span><span style="color:#CED2D6"> ref </span><span style="color:#C792EA">}</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">from</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">&#x27;</span><span style="color:#ECC48D">vue</span><span style="color:#C792EA">&#x27;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#FFA7C4">const </span><span style="color:#CED2D6">count</span><span style="color:#FFA7C4"> </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">ref</span><span style="color:#C792EA">(</span><span style="color:#F78C6C">0</span><span style="color:#C792EA">)</span></span>
<span data-line=""><span style="color:#FFA7C4">export</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">function</span><span style="color:#CED2D6"> </span><span style="color:#8EACE3">useCounter</span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#FFA7C4">return</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">{</span></span>
<span data-line=""><span style="color:#CED2D6">    count</span><span style="color:#C792EA">,</span></span>
<span data-line=""><span style="color:#CED2D6">    </span><span style="color:#8EACE3">inc</span><span style="color:#C792EA">:</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">()</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">=&gt;</span><span style="color:#CED2D6"> </span><span style="color:#FFA7C4">count</span><span style="color:#C792EA">.</span><span style="color:#CED2D6">value</span><span style="color:#C792EA">++</span></span>
<span data-line=""><span style="color:#CED2D6">  </span><span style="color:#C792EA">}</span></span>
<span data-line=""><span style="color:#C792EA">}</span></span></code></pre></div>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="vue" data-theme="default"><code data-language="vue" data-theme="default" style="display:grid"><span data-line=""><span style="color:#C792EA">&lt;</span><span style="color:#FFA7C4">script</span><span style="color:#CED2D6"> </span><span style="color:#C792EA">setup&gt;</span></span>
<span data-line=""><span style="color:#FFA7C4">const { </span><span style="color:#CED2D6">count</span><span style="color:#C792EA">,</span><span style="color:#FFA7C4"> </span><span style="color:#CED2D6">inc</span><span style="color:#FFA7C4"> } </span><span style="color:#C792EA">=</span><span style="color:#FFA7C4"> </span><span style="color:#8EACE3">useCounter</span><span style="color:#C792EA">()</span></span>
<span data-line=""><span style="color:#C792EA">&lt;/</span><span style="color:#FFA7C4">script</span><span style="color:#C792EA">&gt;</span></span></code></pre></div>
<p>多个组件引入 <code>useCounter()</code>，他们看到的是同一个 <code>count</code> 实例，就天然共享状态了。</p>
<p>这是一种“状态即服务”的思路，非常适合复杂场景下的组件复用。</p>
<hr/>
<div data-rehype-pretty-code-fragment=""><pre class="Overnight" style="background-color:var(--code-bg)" tabindex="0" data-language="text" data-theme="default"><code data-language="text" data-theme="default" style="display:grid"><span data-line=""><span style="color:#D6D9E0">  简单 ➝ ➝ ➝ ➝ ➝ ➝ ➝ ➝ ➝ 复杂</span></span>
<span data-line=""><span style="color:#D6D9E0">[props/emit] → [provide/inject] → [eventBus] → [Pinia] → [composables]</span></span>
<span data-line=""><span style="color:#D6D9E0">   ⬆️适合父子     ⬆️适合祖孙     ⬆️松耦合     ⬆️全局状态     ⬆️抽象逻辑</span></span></code></pre></div>
<p>别再纠结“组件通信怎么选”了。选什么方式其实只取决于两件事：</p>
<ul>
<li>谁要通信？</li>
<li>状态在哪维护、谁能控制？</li>
</ul>
<p>把这两个问题答清楚，通信方式自然水落石出。</p>
<h3>🐾 最后的叮咛</h3>
<p>Vue 的组件通信不复杂，复杂的是“业务本身的耦合”。</p>
<p>你与其追求“通信方式要高级”，不如先让你的状态更清晰、结构更合理。通信只是表象，本质上我们是想让状态保持“合理流动”。</p>
<p>用对方式，就像选对交通工具：近就走路，远就开车，再远就坐高铁。别拿走路去赶高铁，别拿高铁去串门。</p><hr/><p><a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://bsky.app/search?q=https%3A%2F%2Foverreacted.io%2Fvue-reactive%2F">Discuss on Bluesky</a>  ·  <a target="_blank" class=" scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="https://github.com/swanine">Edit on GitHub</a></p></div></article><!--$--><!--/$--><!--$--><!--/$--><footer class="mt-12"><a class="__className_096e99 inline-block text-2xl font-black hover:scale-[1.02] scale-100 active:scale-100" style="opacity:1;transition:transform 0.2s ease-in-out, opacity 0.2s 0.4s linear" href="/"><span style="--myColor1:var(--pink);--myColor2:var(--purple);background-image:linear-gradient(45deg, var(--myColor1), var(--myColor2));background-clip:text;-webkit-background-clip:text;color:transparent;transition:--myColor1 0.2s ease-out, --myColor2 0.2s ease-in-out">overreacted</span></a></footer></main><script src="/_next/static/chunks/webpack-cc6f4bbd58f02c04.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[9019,[\"252\",\"static/chunks/252-c08bd2e6e79378f4.js\",\"25\",\"static/chunks/app/%5Bslug%5D/layout-c8e9a29bffafb4da.js\"],\"default\"]\n3:I[4172,[\"252\",\"static/chunks/252-c08bd2e6e79378f4.js\",\"182\",\"static/chunks/app/%5Bslug%5D/page-8d1acff9edb9c31b.js\"],\"default\"]\n4:I[505,[],\"\"]\n5:I[6221,[],\"\"]\n7:I[1327,[],\"MetadataBoundary\"]\n9:I[1327,[],\"OutletBoundary\"]\nc:I[9989,[],\"AsyncMetadataOutlet\"]\ne:I[1327,[],\"ViewportBoundary\"]\n10:I[7992,[],\"\"]\n:HL[\"/_next/static/media/1f3fe8c6df3d47c1-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/4f05ba3a6752a328-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/82050c55ac1c8c11-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/48df2138df2e6856.css\",\"style\"]\n:HL[\"/_next/static/css/7198505728be4078.css\",\"style\"]\n:HL[\"/_next/static/css/354c4f287ddbdae0.css\",\"style\"]\n:HL[\"/_next/static/css/56ee663620872bf0.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"QpSHpR0C-SmZGHI7UkrYg\",\"p\":\"\",\"c\":[\"\",\"vue-reactive\",\"\"],\"i\":false,\"f\":[[[\"\",{\"children\":[[\"slug\",\"vue-reactive\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/48df2138df2e6856.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/7198505728be4078.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"2\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/354c4f287ddbdae0.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"__className_577ed0\",\"children\":[\"$\",\"body\",null,{\"className\":\"mx-auto max-w-2xl bg-[--bg] px-5 py-12 text-[--text]\",\"children\":[[\"$\",\"header\",null,{\"className\":\"mb-14 flex flex-row place-content-between\",\"children\":[[\"$\",\"$L2\",null,{}],[\"$\",\"span\",null,{\"className\":\"relative top-[4px] italic\",\"children\":[\"by\",\" \",[\"$\",\"$L3\",null,{\"href\":\"https://swanine.com\",\"target\":\"_blank\",\"children\":[\"$\",\"img\",null,{\"alt\":\"Swanine\",\"src\":\"https://avatars.githubusercontent.com/u/52339771?v=4\",\"className\":\"relative -top-1 mx-1 inline h-8 w-8 rounded-full\"}]}]]}]]}],[\"$\",\"main\",null,{\"children\":[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"article\",null,{\"className\":\"markdown\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"__className_096e99 text-[40px] font-black leading-[44px] text-[--title]\",\"children\":\"Not found\"}],[\"$\",\"div\",null,{\"className\":\"markdown mt-10\",\"children\":[[\"$\",\"p\",null,{\"children\":\"This page doesn't exist (yet?)\"}],[\"$\",\"p\",null,{\"children\":[\"I recently rewrote the site so maybe something broke. Please\",\" \",[\"$\",\"$L3\",null,{\"href\":\"https://github.com/swanine\",\"children\":\"complain here.\"}]]}],[\"$\",\"p\",null,{\"children\":[\"If you're looking for translated posts, they're not on the site anymore but you can find\",\" \",[\"$\",\"$L3\",null,{\"href\":\"https://github.com/swanine\",\"children\":\"an archive of them here.\"}]]}],[\"$\",\"p\",null,{\"children\":\"Hope you'll find what you're looking for.\"}]]}]]}],[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/56ee663620872bf0.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]}]]}],{\"children\":[[\"slug\",\"vue-reactive\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}],[\"$\",\"footer\",null,{\"className\":\"mt-12\",\"children\":[\"$\",\"$L2\",null,{}]}]]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L6\",[\"$\",\"$L7\",null,{\"children\":\"$L8\"}],[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/56ee663620872bf0.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"$L9\",null,{\"children\":[\"$La\",\"$Lb\",[\"$\",\"$Lc\",null,{\"promise\":\"$@d\"}]]}]]}],{},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"1qYguHr-zRGWByXLECGnq\",{\"children\":[[\"$\",\"$Le\",null,{\"children\":\"$Lf\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],null]}],false]],\"m\":\"$undefined\",\"G\":[\"$10\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"11:\"$Sreact.suspense\"\n12:I[9989,[],\"AsyncMetadata\"]\n8:[\"$\",\"$11\",null,{\"fallback\":null,\"children\":[\"$\",\"$L12\",null,{\"promise\":\"$@13\"}]}]\n"])</script><script>self.__next_f.push([1,"b:null\n"])</script><script>self.__next_f.push([1,"f:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\na:null\n"])</script><script>self.__next_f.push([1,"6:[\"$\",\"article\",null,{\"children\":[[\"$\",\"h1\",null,{\"className\":\"__className_096e99 text-[40px] font-black leading-[44px] text-[--title]\",\"children\":\"别拿“父传子、子传父”吓我了\"}],[\"$\",\"p\",null,{\"className\":\"mt-2 text-[13px] text-gray-700 dark:text-gray-300\",\"children\":\"December 11, 2023\"}],[\"$\",\"div\",null,{\"className\":\"markdown mt-10\",\"children\":[\"$L14\",[\"$\",\"hr\",null,{}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"$L3\",null,{\"href\":\"https://bsky.app/search?q=https%3A%2F%2Foverreacted.io%2Fvue-reactive%2F\",\"children\":\"Discuss on Bluesky\"}],\"  ·  \",[\"$\",\"$L3\",null,{\"href\":\"https://github.com/swanine\",\"children\":\"Edit on GitHub\"}]]}]]}]]}]\n13:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"别拿“父传子、子传父”吓我了 — overreacted\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"献给在 props、emit、eventBus、provide/inject 之间迷失的你\"}],[\"$\",\"link\",\"2\",{\"rel\":\"icon\",\"href\":\"/icon.png?e0852c1e2c7f0e65\",\"type\":\"image/png\",\"sizes\":\"329x329\"}]],\"error\":null,\"digest\":\"$undefined\"}\nd:{\"metadata\":\"$13:metadata\",\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"14:[[\"$\",\"p\",null,{\"children\":[\"我们从小就被告诫，组件之间要“数据单向流动”。Vue 也这样教我们：\\n\",[\"$\",\"strong\",null,{\"children\":[\"父组件通过 \",[\"$\",\"code\",null,{\"children\":\"props\"}],\" 给子组件传值，子组件通过 \",[\"$\",\"code\",null,{\"children\":\"$$emit\"}],\" 通知父组件某个事件发生了\"]}],\"。\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"但你写久了之后就会发现：\\n这事儿根本没那么简单。\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"场景一复杂，层级一多，Vue 的组件通信就会逐渐从“清水煮白菜”变成了“七大姑八大姨串门”——一个 \",[\"$\",\"code\",null,{\"children\":\"props\"}],\" 传了五层，一个 \",[\"$\",\"code\",null,{\"children\":\"emit\"}],\" 被转发三手，一个兄弟组件用全局事件乱吼……\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"别慌，其实这些情况很常见，只是我们以前在学组件通信的时候，太过理想化了。\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"这篇文章我就想聊聊：Vue 组件通信这回事，应该怎么看、怎么写、怎么不把自己写崩。\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h4\",null,{\"children\":\"🧭 组件通信的五大派别（别背 API，先理解思路）\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Vue 组件通信，其实就这几个套路，每一种都有适合它的“场景生态位”：\"}],\"\\n\",[\"$\",\"table\",null,{\"class\":\"grid w-full grid-cols-[auto_auto] border-b border-gray-900/10 dark:border-white/10\",\"children\":[[\"$\",\"thead\",null,{\"class\":\"col-span-3 grid grid-cols-subgrid\",\"children\":[\"$\",\"tr\",null,{\"class\":\"col-span-3 grid grid-cols-subgrid\",\"children\":[[\"$\",\"th\",null,{\"class\":\"px-2 py-2.5 text-left text-sm/7 font-semibold text-gray-950 dark:text-white\",\"children\":\"通信方式\"}],[\"$\",\"th\",null,{\"class\":\"px-2 py-2.5 text-left text-sm/7 font-semibold text-gray-950 dark:text-white\",\"children\":\"适合场景\"}],[\"$\",\"th\",null,{\"class\":\"px-2 py-2.5 text-left text-sm/7 font-semibold text-gray-950 dark:text-white\",\"children\":\"特点\"}]]}]}],[\"$\",\"tbody\",null,{\"class\":\"col-span-3 grid grid-cols-subgrid border-t border-gray-900/10 dark:border-white/10\",\"children\":[[\"$\",\"tr\",null,{\"class\":\"col-span-3 grid grid-cols-subgrid border-b border-gray-950/5 dark:border-white/5\",\"children\":[[\"$\",\"td\",null,{\"class\":\"px-2 py-2 align-top font-mono text-xs/6 font-medium \",\"children\":\"props / emit\"}],[\"$\",\"td\",null,{\"class\":\"px-2 py-2 align-top font-mono text-xs/6 font-medium \",\"children\":\"父子之间\"}],[\"$\",\"td\",null,{\"class\":\"px-2 py-2 align-top font-mono text-xs/6 font-medium \",\"children\":\"单向传值、简单直白\"}]]}],[\"$\",\"tr\",null,{\"class\":\"col-span-3 grid grid-cols-subgrid border-b border-gray-950/5 dark:border-white/5\",\"children\":[[\"$\",\"td\",null,{\"class\":\"px-2 py-2 align-top font-mono text-xs/6 font-medium \",\"children\":\"provide / inject\"}],[\"$\",\"td\",null,{\"class\":\"px-2 py-2 align-top font-mono text-xs/6 font-medium \",\"children\":\"跨层级的祖孙关系\"}],[\"$\",\"td\",null,{\"class\":\"px-2 py-2 align-top font-mono text-xs/6 font-medium \",\"children\":\"解耦、隐式依赖\"}]]}],[\"$\",\"tr\",null,{\"class\":\"col-span-3 grid grid-cols-subgrid border-b border-gray-950/5 dark:border-white/5\",\"children\":[[\"$\",\"td\",null,{\"class\":\"px-2 py-2 align-top font-mono text-xs/6 font-medium \",\"children\":\"事件总线（eventBus）\"}],[\"$\",\"td\",null,{\"class\":\"px-2 py-2 align-top font-mono text-xs/6 font-medium \",\"children\":\"松耦合兄弟、跨组件\"}],[\"$\",\"td\",null,{\"class\":\"px-2 py-2 align-top font-mono text-xs/6 font-medium \",\"children\":\"灵活但容易失控\"}]]}],[\"$\",\"tr\",null,{\"class\":\"col-span-3 grid grid-cols-subgrid border-b border-gray-950/5 dark:border-white/5\",\"children\":[[\"$\",\"td\",null,{\"class\":\"px-2 py-2 align-top font-mono text-xs/6 font-medium \",\"children\":\"Vuex / Pinia\"}],[\"$\",\"td\",null,{\"class\":\"px-2 py-2 align-top font-mono text-xs/6 font-medium \",\"children\":\"跨页面、跨组件、共享状态\"}],[\"$\",\"td\",null,{\"class\":\"px-2 py-2 align-top font-mono text-xs/6 font-medium \",\"children\":\"官方推荐、适合复杂项目\"}]]}],[\"$\",\"tr\",null,{\"class\":\"col-span-3 grid grid-cols-subgrid not-last:border-b not-last:border-gray-950/5 dark:not-last:border-white/5\",\"children\":[[\"$\",\"td\",null,{\"class\":\"px-2 py-2 align-top font-mono text-xs/6 font-medium \",\"children\":\"自定义 hooks / composables\"}],[\"$\",\"td\",null,{\"class\":\"px-2 py-2 align-top font-mono text-xs/6 font-medium \",\"children\":\"可复用状态逻辑\"}],[\"$\",\"td\",null,{\"class\":\"px-2 py-2 align-top font-mono text-xs/6 font-medium \",\"children\":\"灵活组合、自带响应性\"}]]}]]}]]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"这些方式没有对错，\",[\"$\",\"strong\",null,{\"children\":\"关键看你项目的规模和数据流动的复杂度\"}],\"。\"]}],\"\\n\",[\"$\",\"h3\",null,{\"children\":\"🧒 父传子、子传父：新手村里的套路，也有进阶写法\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Vue 最基础的通信方式就是 \",[\"$\",\"code\",null,{\"children\":\"props\"}],\" 和 \",[\"$\",\"code\",null,{\"children\":\"$$emit\"}],\"，学起来简单，但写起来其实也能很“优雅”。\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"✅ 正常写法：\"}]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"vue\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"vue\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"\u003c!-- 父组件 --\u003e\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"MyInput\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" :\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"value=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"username\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" @\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"update=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"username \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" $event\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"/\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"\u003c!-- 子组件 --\u003e\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"template\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"input\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" :value=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"value\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" @input=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"$$emit('update', $event.target.value)\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\" /\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"template\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"script\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"setup\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"defineProps\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"([\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"value\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"])\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"defineEmits\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"([\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"update\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"])\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"script\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"这就是我们常说的“受控组件”：父组件管控数据，子组件通知变化。\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"🚀 更进一步：v-model 语法糖\"}]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"vue\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"vue\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"\u003c!-- 父组件 --\u003e\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"MyInput\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"v-model=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"username\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"/\u003e\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"你以为这是语法糖，其实底层就是 \",[\"$\",\"code\",null,{\"children\":\":modelValue\"}],\" + \",[\"$\",\"code\",null,{\"children\":\"@update:modelValue\"}],\"，Vue 帮你自动做了参数和事件名的约定而已。\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"写起来舒服多了，也方便统一封装一堆表单类组件。\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"children\":\"👴 provide / inject：爷爷给孙子发钱，谁也别告诉爸爸\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"当你 \",[\"$\",\"code\",null,{\"children\":\"props\"}],\" 传了三四层，组件都在当“中转站”时，就该考虑换个思路了。\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Vue 提供了 \",[\"$\",\"code\",null,{\"children\":\"provide\"}],\" / \",[\"$\",\"code\",null,{\"children\":\"inject\"}],\"，可以让\",[\"$\",\"strong\",null,{\"children\":\"祖先组件向任意后代组件提供数据\"}],\"，后代随用随取，不需要层层传递。\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"js\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"js\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// App.vue\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"provide\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"theme\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"dark\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// Button.vue（第5层）\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"theme\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"inject\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"theme\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"这套机制适合“全局但不常变的数据”，比如主题、语言、配置项等等。\"}],\"\\n\",[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":\"❗ 提醒：虽然它很方便，但用多了容易让组件间关系变得隐蔽，阅读成本高。所以更适合“结构性通信”，不太适合“业务值通信”。\"}],\"\\n\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"children\":\"🤝 兄弟组件通信：你俩又不认识，别硬聊！\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"兄弟组件不能直接用 \",[\"$\",\"code\",null,{\"children\":\"props/emit\"}],\"，但有时偏偏要互动，比如：\"]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"左边的侧边栏点击切换，右边内容区要响应\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"表格和分页是兄弟组件，共享查询参数\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"这时有几种方式可以解耦：\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"✅ 共享父组件作为“中介人”\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"父组件统一管理状态，两个兄弟通过 \",[\"$\",\"code\",null,{\"children\":\"props\"}],\" 和 \",[\"$\",\"code\",null,{\"children\":\"emit\"}],\" 各自接入。\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"💣 用 eventBus 快速接上（但别上瘾）\"}]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"js\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"js\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// eventBus.js\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"export const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"eventBus\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"mitt\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// A组件\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"eventBus\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"emit\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"search\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"关键词\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// B组件\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"eventBus\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"on\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"search\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"val\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"doSearch\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"val\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"})\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"这方式快捷灵活，但容易到处注册/解绑，特别容易内存泄漏 or 逻辑混乱。建议小项目或 demo 里用用，别做核心依赖。\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"children\":\"🏢 Pinia / Vuex：让组件都变成“打工人”\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"如果一个状态不仅要被多个组件使用，还要长期存在（比如用户信息、购物车数据、权限表），这时候你就该上 Pinia 了。\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"它其实是一个“响应式的数据工厂”：你在里面定义状态、动作，组件从中取用和更新，一切都响应式同步。\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"js\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"js\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// store/user.js\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"export const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"useUserStore\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"defineStore\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"user\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"state\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"({\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" name\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"小张\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" token\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"''\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}),\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"actions\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"logout\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"token \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"''\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"})\"}]}]]}]}]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"vue\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"vue\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"script\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"setup\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"user\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useUserStore\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"user\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"name \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// 响应式的\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"script\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"现在 Vue 的状态管理，已经越来越模块化、组合化，Pinia 比 Vuex 更轻量，语法也更现代。\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"children\":\"🧩 自定义 composable：组件通信之外的终极解耦武器\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"最后介绍一个高手段：\",[\"$\",\"strong\",null,{\"children\":\"提取状态和逻辑到\"}],\" \",[\"$\",\"code\",null,{\"children\":\"useXXX()\"}],\" ** composable 函数中**，多个组件使用同一个逻辑，就天然“通信”了。\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"js\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"js\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#637777\"},\"children\":\"// useCounter.js\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" ref \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ECC48D\"},\"children\":\"vue\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"'\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F78C6C\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useCounter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"{\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"    \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"inc\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"value\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"++\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"vue\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"vue\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"script\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"setup\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"const { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#CED2D6\"},\"children\":\"inc\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" } \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#8EACE3\"},\"children\":\"useCounter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"()\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFA7C4\"},\"children\":\"script\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C792EA\"},\"children\":\"\u003e\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"多个组件引入 \",[\"$\",\"code\",null,{\"children\":\"useCounter()\"}],\"，他们看到的是同一个 \",[\"$\",\"code\",null,{\"children\":\"count\"}],\" 实例，就天然共享状态了。\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"这是一种“状态即服务”的思路，非常适合复杂场景下的组件复用。\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"Overnight\",\"style\":{\"backgroundColor\":\"var(--code-bg)\"},\"tabIndex\":\"0\",\"data-language\":\"text\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"text\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#D6D9E0\"},\"children\":\"  简单 ➝ ➝ ➝ ➝ ➝ ➝ ➝ ➝ ➝ 复杂\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#D6D9E0\"},\"children\":\"[props/emit] → [provide/inject] → [eventBus] → [Pinia] → [composables]\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#D6D9E0\"},\"children\":\"   ⬆️适合父子     ⬆️适合祖孙     ⬆️松耦合     ⬆️全局状态     ⬆️抽象逻辑\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"别再纠结“组件通信怎么选”了。选什么方式其实只取决于两件事：\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"谁要通信？\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"状态在哪维护、谁能控制？\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"把这两个问题答清楚，通信方式自然水落石出。\"}],\"\\n\",[\"$\",\"h3\",null,{\"children\":\"🐾 最后的叮咛\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Vue 的组件通信不复杂，复杂的是“业务本身的耦合”。\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"你与其追求“通信方式要高级”，不如先让你的状态更清晰、结构更合理。通信只是表象，本质上我们是想让状态保持“合理流动”。\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"用对方式，就像选对交通工具：近就走路，远就开车，再远就坐高铁。别拿走路去赶高铁，别拿高铁去串门。\"}]]\n"])</script></body></html>